{% extends "base.html" %}
{% load static %}

{% block content %}

    <h1>一時保存したレビュー</h1>

    {% if drafts %}
        <ul>
            {% for draft in drafts %}
                <li style="margin-bottom:16px;">
                    <strong>{{ draft.product.cosme_name }}</strong><br>
                    
                    {% if draft.image %}
                        <img src="{{ draft.image.url }}" class="draft-review-image">
                    {% elif draft.product.image %}
                        <img src="{{ draft.product.image.url }}" class="draft-review-image">
                    {% endif %}

                    {% if draft.rating %}
                        <p>評価：{{ draft.get_rating_display }}</p>
                    {% endif %}

                    {% if draft.goodpoint_comment %}
                        <p>
                            <strong>良い点</strong><br>
                            {{ draft.goodpoint_comment|truncatechars:50 }}
                        </p>
                    {% endif %}

                    {% if draft.badpoint_comment %}
                        <p>
                            <strong>悪い点</strong><br>
                            {{ draft.badpoint_comment|truncatechars:50 }}
                        </p>
                    {% endif %}

                    保存日：{{ draft.created_at|date:"Y/m/d H:i" }}<br>

                    <a href="{% url 'form_app:review_draft_edit' draft.id %}">
                        編集
                    </a>
                    
                    <form 
                        action ="{% url 'form_app:review_draft_delete' draft.id %}"
                        method="post"
                        onsubmit="return confirm('この下書きを削除しますか？');"
                        style="display:inline;"
                    >
                        {% csrf_token %}
                        <button type="submit">削除</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>一時保存したレビューはありません。</p>
    {% endif %}

{% endblock %}