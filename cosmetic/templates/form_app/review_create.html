{% extends "base.html" %}
{% load static %}


{% block content %}

<div class="review-header">
    <h1>ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿</h1>

    <a href = "{% url 'form_app:review_draft_list' %}" class="btn btn-secondary">
        ğŸ“ä¸€æ™‚ä¿å­˜ã—ãŸãƒ¬ãƒ“ãƒ¥ãƒ¼
    </a>
</div>

<div class="product-box">
    <div class="product-image">
        {% if product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.cosme_name }}" style="width:150px;">
        {% endif %}
    </div>

    <div class="product-info">
        <h2>{{ product.cosme_name }}</h2>
        <p>ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼š{{ product.category }}</p>
        <p>ä¾¡æ ¼ï¼šï¿¥{{ product.price }}</p>
    </div>
</div>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <div class="rating-container">
        <span class="rating-label">è©•ä¾¡ï¼š</span>
        
        <!--ã‚¨ãƒ©ãƒ¼ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—-->
        <script>
            {% if form.rating.errors %}
                alert("è©•ä¾¡ï¼ˆâ˜…ï¼‰ã‚’é¸æŠã—ã¦ãã ã•ã„");
            {% endif %}
        </script>

        <!--ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³-->
        <div class="rating-options">
            {% for value,label in form.rating.field.choices %}
                {% if value != "" %}
                    <label class="rating-item">
                        <input type="radio" name="rating" value="{{ value }}">
                        {{ label }}
                    </label>
                {% endif %}
            {% endfor %}
        </div>

          <!--ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç”»åƒé¸æŠ-->
        <div>
            {{ form.image }}
        </div>
    </div>

  
    <p>
        <label>è‰¯ã„ç‚¹ï¼š</label><br>
        {{ form.goodpoint_comment }}
    </p>

    <p>
        <label>æ‚ªã„ç‚¹ï¼š</label><br>
        {{ form.badpoint_comment }}
    </p>

    <div class="submit-actions">
        <button type="submit" name="action" value="submit" class="btn-submit">
            æŠ•ç¨¿
        </button>
        
        <div class="submit-links">
            <a href="{% url 'form_app:my_page' %}" class="link-cancel">
                ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </a>

            <button type="submit" name="action" value="draft" class="link-draft">
                ä¸€æ™‚ä¿å­˜
            </button> 
        </div>
    </div>
</form>

<script>
    const input = document.querySelector('input[type="file"]');
    const preview = document.getElementById('preview');

    if(input){
        input.addEventListener('change', function(){
            const file = this.files[0];
            if(file){
                const render = new FileReader();
                render.onload = function(e){
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                render.readAsDataURL(file);
            }
        });
    }
</script>

{% endblock %}