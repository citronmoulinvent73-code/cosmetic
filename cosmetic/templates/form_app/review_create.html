{% extends "base.html" %}
{% load static %}


{% block content %}

<div class="review-header">
    <h1 class="page-title">ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿</h1>

    <a href = "{% url 'form_app:review_draft_list' %}" class="btn btn-secondary">
        ğŸ’¾ä¸€æ™‚ä¿å­˜ã—ãŸãƒ¬ãƒ“ãƒ¥ãƒ¼
    </a>
</div>

<div class="product-box">
    <div class="product-thumb">
        <!--<div class="product-image">-->
        <img src="{{ product.image.url }}" class="product-thumb-img" alt="{{ product.cosme_name }}">
    </div>

    <div class="product-info">
        <h2>{{ product.cosme_name }}</h2>
        <p>ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼š{{ product.category }}</p>
        <p>ä¾¡æ ¼ï¼šï¿¥{{ product.price }}</p>
    </div>
</div>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <div class="rating-container">
        <span class="rating-label">è©•ä¾¡ï¼š</span>      

        <div class="rating-error">
            {{ form.rating.errors }}
        </div>

        <!--â˜†ãƒœã‚¿ãƒ³-->
        <div class="rating-stars" aria-label="è©•ä¾¡">
            {% for value,label in form.rating.field.choices %}
                {% if value != "" %}
                    <input 
                    type="radio"
                    id="star{{ value }}"
                    name="rating"
                    value="{{ value }}"
                    {% if selected|stringformat:"s" == value|stringformat:"s" %}checked{% endif %}
                    >
                    <label for="star{{ value }}">â˜…</label>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <!--ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç”»åƒé¸æŠ-->
    <div class="image-upload">
        {{ form.image.errors }}
        {{ form.image }}
        <img id="preview" class="preview hidden" alt="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">
    </div>

  
    <p>
        <label>è‰¯ã„ç‚¹ï¼š</label><br>
        {{ form.goodpoint_comment.errors }}
        {{ form.goodpoint_comment }}
    </p>

    <p>
        <label>æ‚ªã„ç‚¹ï¼š</label><br>
        {{ form.badpoint_comment.errors }}
        {{ form.badpoint_comment }}
    </p>


    <div class="submit-actions">
        <button type="submit" name="action" value="submit" class="btn-submit">
            æŠ•ç¨¿
        </button>
    
        <div class="submit-links">
            {% if request.user.is_staff %}
                <a href="{% url 'form_app:admin_my_page' %}" class="link-cancel">
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </a>
            {% else %}
                <a href="{% url 'form_app:my_page' %}" class="link-cancel">
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </a>
            {% endif %}

            <!--a href="{% url 'form_app:my_page' %}" class="link-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a-->

            <button type="submit" name="action" value="draft" class="link-draft">
                ä¸€æ™‚ä¿å­˜
            </button> 
        </div>
    </div>
</form>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const input = document.querySelector('input[type="file"]');
    const preview = document.getElementById('preview');

    if(!input || !preview) return;

    
    input.addEventListener('change', () => {
        const file = input.files && input.files[0];

        if(!file){
            preview.src = "";
            preview.classList.add("hidden");
            return;
        }

        preview.src = URL.createObjectURL(file);
        preview.classList.remove("hidden");
    });
});

</script>

{% endblock %}